<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>redux</title>
  <script src="https://cdn.bootcss.com/redux/4.0.0/redux.min.js"></script>
</head>

<body>
  <div id="app">

  </div>
  <script>
    function add1() {
      store.dispatch({ type: 'add', payload: 1 })
    }
    function add2() {
      store.dispatch({ type: 'add', payload: 2 })
    }
    function minus1() {
      store.dispatch({ type: 'minus' })
    }

    function addIf() {
      var oldState = store.getState()
      if (oldState % 2 === 1) {
        store.dispatch({ type: 'add', payload: 1 })
      }
    }

    function addAsync() {
      setTimeout(() => {
        store.dispatch({ type: 'add', payload: 1 })
      }, 2000)
    }

    function render(store) {
      var app = document.querySelector('#app')
      app.innerHTML = `
      <div>
        您点击了<span>${store.getState()}</span>次
        <div>
          <button id="add1" onClick="add1()">+1</button>
          <button id="add2" onClick="add2()">+2</button>
          <button id="minus" onClick="minus1()">-1</button>
          <button id="add1IfOdd" onClick="addIf()">如果是单数+1</button>
          <button id="add1After2Sec" onClick="addAsync()">两秒钟后+1</button>
        </div>
      </div>
      `
    }

    function stateChanger(state, action) {
      if (state === undefined) {
        return 0
      } else {
        if (action.type === 'add') {
          var newState = state + action.payload
          return newState
        } else if (action.type === 'minus') {
          return state - 1
        }
      }
    }
    var store = Redux.createStore(stateChanger)
    render(store)
    store.subscribe(() => {
      render(store)
    })
  </script>
</body>

</html>